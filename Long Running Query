select pid,now(),now() - pg_stat_activity.query_start as duration,substr(pg_stat_activity.query, 1, 100) as query,pg_stat_activity.client_addr as ip_addr,state,pg_stat_activity.usename as username from pg_stat_activity where state='active' order by duration desc limit 30;
